board: m5stack_cores3
chip: esp32s3
version: 1.0.0
# Devices Configuration
devices:
  - name: gpio_expander
    chip: aw9523b
    type: gpio_expander
    version: default
    dependencies:
      esp_io_expander_aw9523b:
        override_path: "${BOARD_PATH}/components/esp_io_expander_aw9523b"
        require: public
    config:
      max_pins: 16
      # When the level of pin1 and pin5 of the IO expansion chip is set to 0,
      # the device can be powered by the Grove interface or the DC power interface,
      # but at this time, using SD card and LCD simultaneously may cause a crash issue.
      output_io_mask: [0, 1, 2, 4, 5, 8, 9, 10, 11]
      output_io_level_mask: [0, 0, 0, 0, 0, 0, 0, 0, 0]
      input_io_mask: NULL
    peripherals:
      - name: i2c_master
        i2c_addr: [0xb0]

  - name: axp2101_power_manager
    chip: axp2101
    type: custom
    version: default
    config:
      frequency: 400000
      i2c_addr: 0x34
    peripherals:
      - name: i2c_master

  - name: audio_dac
    chip: aw88298
    type: audio_codec
    version: default
    config:
      adc_enabled: false
      dac_enabled: true
      dac_max_channel: 1
      dac_channel_mask: "1"
      dac_init_gain: 0

      # Audio processing settings
      mclk_enabled: false

    peripherals:
      - name: i2s_audio_out
      - name: i2c_master
        address: 0x6c
        frequency: 400000

  - name: audio_adc
    chip: es7210
    type: audio_codec
    version: default
    config:
      adc_enabled: true
      adc_max_channel: 4
      adc_channel_mask: "0011"
      adc_init_gain: 0

    # Power amplifier configuration
    peripherals:
      - name: i2s_audio_in
      - name: i2c_master
        address: 0x80
        frequency: 400000

  # SD Card Configuration, it is recommended not to use it with LCD
  # Using them simultaneously may cause SD card mount failure or program crashes due to SPI resource conflicts
  # - name: fs_sdcard
  #   type: fatfs_sdcard_spi
  #   config:
  #     cs_gpio_num: 4
  #     frequency: SDMMC_FREQ_DEFAULT
  #     peripherals:
  #       - name: "spi_master"

  - name: display_lcd
    chip: ili9342
    type: display_lcd_spi
    version: default
    dependencies:
      espressif/esp_lcd_ili9341: "*"
    config:
      mirror_x: false
      mirror_y: false
      x_max: 320
      y_max: 240
      invert_color: true  # Need to invert color for M5Stack CoreS3 LCD
      io_spi_config:
        cs_gpio_num: 3
        dc_gpio_num: 35
        spi_mode: 0
        pclk_hz: 40000000
        flags:
          sio_mode: true
        peripherals:
          - name: spi_master

      lcd_panel_config:
        reset_gpio_num: -1
        rgb_ele_order: LCD_RGB_ELEMENT_ORDER_BGR
        bits_per_pixel: 16
        data_endian: LCD_RGB_DATA_ENDIAN_BIG
        flags:
          reset_active_high: true

  # Touch Panel Configuration
  - name: lcd_touch
    chip: ft5x06
    type: lcd_touch_i2c
    version: default
    dependencies:
      esp_lcd_touch:
        version: "*"
        require: public
      espressif/esp_lcd_touch_ft5x06: "^1.0.0"
    config:
      io_i2c_config:
        dev_addr: [0x38]
        lcd_cmd_bits: 8
        scl_speed_hz: 400000
        peripherals:
          - name: i2c_master

      touch_config:
        x_max: 320
        y_max: 240
